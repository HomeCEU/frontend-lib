<form [formGroup]="templateEditor" (ngSubmit)="onSubmit()">
  <div class="flex-row">
    <mat-form-field class="templateKey">
      <mat-label>Template Name</mat-label>
      <input matInput type="text" formControlName="templateKey" [readonly]="existingTemplate">
    </mat-form-field>
    <div class="push">
      <mat-form-field class="dataKey">
        <mat-label>Data Key</mat-label>
        <input matInput type="text" formControlName="dataKey">
      </mat-form-field>
      <button [disabled]="!templateEditor.value.dataKey" (click)="renderTemplate()" type="button" mat-button>
        Preview
      </button>
    </div>
  </div>
  <div class="flex-row">
    <button type="button" (click)="copyTemplate()" [disabled]="canCopy()" mat-button>
      Copy
    </button>
    <button type="button" (click)="discardChangesAndClose()" mat-button>
      Close
    </button>
    <div class="statusMessage">
      <span class="errorMessage" *ngIf="templateEditor.controls.templateKey.errors?.inUse">
        Template name is in use. Please choose another name.
      </span>
      <span class="errorMessage" *ngIf="templateEditor.errors?.saveFailed">
        Save failed. Please try again.
      </span>
      <span class="statusMessage" *ngIf="statusMessage != ''">
        {{ statusMessage }}
      </span>
    </div>
    <button id="saveButton" type="submit" [disabled]="!canSave()" mat-button>
      Save
    </button>
    <button type="button" (click)="toggleDataFields()" class="push" mat-button>
      Fields
    </button>
  </div>
  <div class="flex-row">
    <div style="flex: 1">
      <!-- CKEditor control -->
      <div id="editor1" name="editor1">
      </div>
    </div>
    <div class="dataFieldContainer" [hidden]="dataFieldsVisible">
      <div class="dataFieldHeaderContainer"></div>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Student
          </mat-panel-title>
        </mat-expansion-panel-header>
        <ul id="dataFieldListStudent" class="dataFieldList">
          <li *ngFor = "let dataField of DATAFIELDSSTUDENT index as i" data-dataFieldType="student" [attr.data-dataFieldElement]="i" class="dataFieldElement" draggable="true">
            {{dataField.description}}
          </li>
        </ul>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Course
          </mat-panel-title>
        </mat-expansion-panel-header>
        <ul id="dataFieldListCourse" class="dataFieldList">
          <li *ngFor = "let dataField of DATAFIELDSCOURSE index as i" data-dataFieldType="course" [attr.data-dataFieldElement]="i" class="dataFieldElement" draggable="true">
            {{dataField.description}}
          </li>
        </ul>
      </mat-expansion-panel>
      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Standard Accreditation
          </mat-panel-title>
        </mat-expansion-panel-header>
        <ul id="dataFieldListStandardAcc" class="dataFieldList">
          <li *ngFor = "let dataField of DATAFIELDSSTANDARD index as i" data-dataFieldType="standardAcc" [attr.data-dataFieldElement]="i" class="dataFieldElement" draggable="true">
            {{dataField.description}}
          </li>
        </ul>
      </mat-expansion-panel>

      <mat-expansion-panel>
        <mat-expansion-panel-header>
          <mat-panel-title>
            Nursing Accreditation
          </mat-panel-title>
        </mat-expansion-panel-header>
        <ul id="dataFieldListNursingAcc" class="dataFieldList">
          <li *ngFor = "let dataField of DATAFIELDSNURSING index as i" data-dataFieldType="NursingAcc" [attr.data-dataFieldElement]="i" class="dataFieldElement" draggable="true">
            {{dataField.description}}
          </li>
        </ul>
      </mat-expansion-panel>
    </div>
  </div>
</form>

