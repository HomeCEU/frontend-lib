<form [formGroup]="templateEditor" (ngSubmit)="onSubmit()">
  <div class="flex-row">
    <mat-form-field class="templateKey">
      <mat-label>Template Name</mat-label>
      <input matInput type="text" formControlName="key" [readonly]="existingTemplate" (keydown.space)="$event.preventDefault()">
    </mat-form-field>
    <div class="push">
      <mat-form-field class="dataKey">
        <mat-label>Data Key</mat-label>
        <input matInput type="text" formControlName="dataKey">
      </mat-form-field>
      <button id="close" mat-icon-button (click)="discardChangesAndClose()">
        <mat-icon>close</mat-icon>
      </button>
      <button id="preview" [disabled]="!templateEditor.value.dataKey" (click)="renderTemplate()" type="button" mat-button>
        Preview
      </button>
    </div>
  </div>
  <div class="flex-row">
    <button id="copy" type="button" (click)="copyTemplate()" [disabled]="canCopy()" mat-button>
      Copy
    </button>
    <button id="save" type="submit" mat-button [disabled]="templateEditor.invalid">
      Save
    </button>
    <div class="statusMessage">
      <span class="statusMessage" *ngIf="statusMessage != ''">
        {{ statusMessage }}
      </span>
    </div>

    <button type="button" (click)="toggleDataFields()" class="push" *ngIf="templateType !== templateTypeEnum.image" mat-button>
      Fields
    </button>
  </div>
  <div class="flex-row">
    <div style="flex: 1">
      <!-- CKEditor control -->
      <div id="editor1" name="editor1">
      </div>
    </div>
    <div class="dataFieldContainer" [hidden]="!dataFieldsVisible || templateType === templateTypeEnum.image">
      <mat-accordion multi="false">
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Student
            </mat-panel-title>
          </mat-expansion-panel-header>
          <ul id="dataFieldListStudent" class="dataFieldList">
            <li *ngFor = "let dataField of dragAndDropDataFieldStudent index as i" data-dataFieldType="student" [attr.data-dataFieldElement]="i" class="dataFieldElement" draggable="true">
              {{dataField.description}}
            </li>
          </ul>
        </mat-expansion-panel>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Course
            </mat-panel-title>
          </mat-expansion-panel-header>
          <ul id="dataFieldListCourse" class="dataFieldList">
            <li *ngFor = "let dataField of dragAndDropDataFieldCourse index as i" data-dataFieldType="course" [attr.data-dataFieldElement]="i" class="dataFieldElement" draggable="true">
              {{dataField.description}}
            </li>
          </ul>
        </mat-expansion-panel>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Partials
            </mat-panel-title>
          </mat-expansion-panel-header>
          <ul id="dataFieldListPartial" class="dataFieldList" >
            <li *ngFor = "let dataField of dragAndDropDataFieldPartial index as i" data-dataFieldType="partialFieldType" [attr.data-dataFieldElement]="i" class="dataFieldElement" draggable="true">
              {{dataField.description}}
            </li>
          </ul>
        </mat-expansion-panel>
        <mat-expansion-panel>
          <mat-expansion-panel-header>
            <mat-panel-title>
              Images
            </mat-panel-title>
          </mat-expansion-panel-header>
          <ul id="dataFieldListImage" class="dataFieldList">
            <li *ngFor = "let dataField of dragAndDropDataFieldImage index as i" data-dataFieldType="imageFieldType" [attr.data-dataFieldElement]="i" class="dataFieldElement" draggable="true">
              {{dataField.description}}
            </li>
          </ul>
        </mat-expansion-panel>
      </mat-accordion>
    </div>
  </div>
  <div *ngIf="templateType === templateTypeEnum.image">
    <input type="file" (change)="fileChangeEvent($event)">
  </div>
</form>

